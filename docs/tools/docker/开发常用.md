## 镜像选择

尽量选择 `Alpine` 版本，体积小，使用`apk`安装依赖，如 `apk add --no-cache gcc g++ python2`

> 如需要python2，尽量使用 alpine 3.14 左右的版本


## 镜像对比

| **属性**         | **Alpine + apk**   | **Ubuntu + apt** | **Debian Slim**  | **Distroless** | **BusyBox**      |
|-------------------|--------------------|------------------|------------------|----------------|------------------|
| **镜像大小**     | 5MB                | 29MB             | 20MB             | 极小           | 1MB              |
| **兼容性**       | 较低（需配置）     | 高               | 较高             | 静态编译       | 非常低           |
| **生态支持**     | 较少               | 丰富             | 丰富             | 无包管理器     | 基本无           |
| **配置复杂度**   | 较高（需调整）     | 较低             | 较低             | 中等           | 高               |

## alpine 设置时区

```bash
apk add --no-cache tzdata
cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && echo 'Asia/Shanghai' > /etc/timezone
```
可参考dockerfile
```dockerfile title="dockerfile"
# Use the official Alpine image
FROM alpine:latest

# Set the environment variable for the timezone
ENV TZ=UTC
#ENV TZ=Asia/Shanghai

# Install tzdata package for timezone data
RUN apk add --no-cache tzdata

# Set the timezone
RUN cp /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone

# Verify the timezone is set correctly
RUN date

# Your application setup goes here
# ...

# Example entrypoint
CMD ["sh"]
```

## postgres

```bash
podman run --rm -p 5432:5432 -e POSTGRES_USER=postgres -e POSTGRES_PASSWORD=postgres -e POSTGRES_DB=hello_dev postgres:12.19-alpine

# -v "$PWD/data":/var/lib/postgresql/data
```

## redis

```bash
docker run --rm -p 6379:6379 redis

# -v "$PWD/data":/data
```

## mysql

```bash
docker run --rm -e MYSQL_ROOT_PASSWORD=root -e MYSQL_DATABASE=<default db> -p 3306:3306 mysql

# -v "$PWD/data":/var/lib/mysql
```

## mongodb

```bash
docker run --rm -p 27017:27017 mongo

# -v "$PWD/data":/data/db
```

## 编译设置代理

```bash
docker build -t ai:latest . --build-arg HTTP_PROXY=http://<ip>:<port>
```

## 映射目录问题(windows环境)

```bash
# cmd
docker run --rm -it -v %cd%:/user/src/app gcc
# powershell
docker run --rm -it -v ${PWD}:/user/src/app gcc
# linux
docker run --rm -it -v ${pwd}:/user/src/app gcc
# cross platform
docker run --rm -it -v ${PWD}:/user/src/app gcc
docker run --rm -it -v ${PWD}:/user/src/app gcc
```

